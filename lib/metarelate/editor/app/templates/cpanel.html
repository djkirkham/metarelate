{% extends "base.html" %}

<!--
# (C) British Crown Copyright 2013, Met Office
#
# This file is part of metarelate.
#
# metarelate is free software: you can redistribute it and/or 
# modify it under the terms of the GNU Lesser General Public License 
# as published by the Free Software Foundation, either version 3 of 
# the License, or (at your option) any later version.
#
# metarelate is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
# GNU Lesser General Public License for more details.
#
# You should have received a copy of the GNU Lesser General Public License
# along with metarelate. If not, see <http://www.gnu.org/licenses/>.
-->


{% block title %}: {{ title }}{% endblock %}

{% block head %}
{% load staticfiles %}
<link href="{% static "main.css" %}"
<script type="text/javascript" src="{% static "jquery-1.7.2.min.js" %}"></script>
<script src="{% static "js/RelatedObjectLookups.js" %}"></script>
<script type="text/javascript" language="javascript">
function current_url() {
  var text = "I propose these changes to Metarelate's metOcean knowledge base.\n";
  text += "The changes are correct, to the best of my knowledge.\n";
  text += "I agree to my username being used to label these changes.\n";

  var url = window.location ;
  document.cpanel.issue_text.value = text + url ;
}
window.onload = current_url ;
</script>

{% endblock %}



{% block content %}

<p>
<a href="{% url 'search' %}"> search </a>
<p>


{% if form %}

<h2>Control Panel</h2>
<form action="" method="post" name="cpanel">

<!-- <p> -->
<!-- <input class="recordbutton" type="submit" {% if read_only %}disabled="disabled"{% endif %} name="load" value="Load Data from Static Data to the local Triplestore"/> -->
<!-- <p> -->
<!-- <input class="recordbutton" type="submit" {% if read_only %}disabled="disabled"{% endif %} name="revert" value="Revert the Triplestore to the  Static Data State"/> -->
<p>
Validate the current merge of this branch and master:
<p>
<input class="recordbutton" type="submit" {% if read_only %}disabled="disabled"{% endif %} name="validate" value="{{ branch }}" label="Validate"/>

<p>
{% if user.is_authenticated %}
{% if ownership %}

{% if upload %}

{% for up in upload %}

<p>
<a href="{{ up.url }}">{{ up.label }}</a>
{{ up.docstring }}
<p>

{% endfor %}

{% endif %}

<p>

To raise a ticket requesting that this branch be merged onto the project, please copy the text below and a link to this page to\
 a new issue on our <a href="https://github.com/metarelate/metOcean/issues/new" target="_blank">github page</a>.
<p>
<textarea readonly="readonly" rows="6" cols="128" wrap="soft" name="issue_text">

</textarea>



<p>
Delete this branch:
<p>
(this cannot be undone)
<p>
<input class="recordbutton" type="submit" {% if read_only %}disabled="disabled"{% endif %} name="delete" value="{{ branch }}" label="Branch"/>
<p>

{% if metarelateuser %}
Merge this branch:
<p>
<input class="recordbutton" type="submit" {% if read_only %}disabled="disabled"{% endif %} name="merge" value="{{ branch }}" label="Merge"/>
<p>
{% endif %}

{% endif %}


{% if not branch %}
Create a new branch:
<p>
<input class="recordbutton" type="submit" {% if read_only %}disabled="disabled"{% endif %} name="branch" value="branch" label="Branch"/>
<p>
{% endif %}
{% endif %}


{% if mappings %}
<h3>Live mappings in this branch:</h3>
{% for mapping in mappings %}

    <ul>
    <li><a href="{{ mapping.url }}">{{ mapping.label }}</a></li>
    </ul>


{% endfor %}

{% endif %}

{% if save_string %}
<textarea readonly="readonly" rows="70" cols="128" wrap="soft">
{{ save_string }}
</textarea>
{% endif %}

{% if invalid %}

{% for inv in invalid %}

  <h3>{{ inv.label }}</h3>

  {% for mapping in inv.mappings %}
    <ul>
    <li><a href="{{ mapping.url }}">{{ mapping.label }}</a></li>
    </ul>
  {% endfor %}

{% endfor %}
{% endif %}


{% csrf_token %}

{{ form.as_p }}



</form>
{% endif %}


{% endblock %}
